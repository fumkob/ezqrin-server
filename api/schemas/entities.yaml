# Core Entity Schemas
# These define the primary business entities in the ezQRin system

User:
  type: object
  required:
    - id
    - email
    - name
    - role
  properties:
    id:
      type: string
      format: uuid
      description: User unique identifier
      example: "550e8400-e29b-41d4-a716-446655440000"
      readOnly: true
    email:
      type: string
      format: email
      minLength: 1
      maxLength: 255
      description: Email address (unique)
      example: "user@example.com"
    name:
      type: string
      minLength: 1
      maxLength: 255
      description: Full name
      example: "John Doe"
    role:
      $ref: './enums.yaml#/UserRole'
    created_at:
      type: string
      format: date-time
      description: Creation timestamp (ISO 8601)
      example: "2025-11-08T10:00:00Z"
      readOnly: true
    updated_at:
      type: string
      format: date-time
      description: Last update timestamp (ISO 8601)
      example: "2025-11-08T10:00:00Z"
      readOnly: true

Event:
  type: object
  required:
    - id
    - organizer_id
    - name
    - start_date
    - status
  properties:
    id:
      type: string
      format: uuid
      description: Event unique identifier
      example: "550e8400-e29b-41d4-a716-446655440000"
      readOnly: true
    organizer_id:
      type: string
      format: uuid
      description: Event owner user ID
      example: "660e8400-e29b-41d4-a716-446655440000"
      readOnly: true
    organizer:
      type: object
      description: Event owner user details (included in detail views only)
      readOnly: true
      properties:
        id:
          type: string
          format: uuid
          example: "660e8400-e29b-41d4-a716-446655440000"
        name:
          type: string
          example: "John Doe"
        email:
          type: string
          format: email
          example: "john@example.com"
    name:
      type: string
      minLength: 1
      maxLength: 255
      description: Event name
      example: "Tech Conference 2025"
    description:
      type: string
      maxLength: 5000
      description: Event description
      example: "Annual technology conference"
    start_date:
      type: string
      format: date-time
      description: Event start date and time (ISO 8601)
      example: "2025-12-15T09:00:00Z"
    end_date:
      type: string
      format: date-time
      description: Event end date and time (ISO 8601, must be after start_date)
      example: "2025-12-15T18:00:00Z"
    location:
      type: string
      maxLength: 500
      description: Venue or location
      example: "San Francisco Convention Center"
    timezone:
      type: string
      description: IANA timezone identifier
      example: "America/Los_Angeles"
      default: "Asia/Tokyo"
    status:
      $ref: './enums.yaml#/EventStatus'
    participant_count:
      type: integer
      minimum: 0
      description: Total registered participants
      example: 150
      readOnly: true
    checked_in_count:
      type: integer
      minimum: 0
      description: Number of checked-in participants
      example: 0
      readOnly: true
    created_at:
      type: string
      format: date-time
      description: Creation timestamp (ISO 8601)
      example: "2025-11-08T10:00:00Z"
      readOnly: true
    updated_at:
      type: string
      format: date-time
      description: Last update timestamp (ISO 8601)
      example: "2025-11-08T10:00:00Z"
      readOnly: true

Participant:
  type: object
  required:
    - id
    - event_id
    - name
    - email
    - status
    - qr_code
  properties:
    id:
      type: string
      format: uuid
      description: Participant unique identifier
      example: "770e8400-e29b-41d4-a716-446655440000"
      readOnly: true
    event_id:
      type: string
      format: uuid
      description: Associated event ID
      example: "550e8400-e29b-41d4-a716-446655440000"
      readOnly: true
    name:
      type: string
      minLength: 1
      maxLength: 255
      description: Participant full name
      example: "Jane Smith"
    email:
      type: string
      format: email
      minLength: 1
      maxLength: 255
      description: Email address (unique per event)
      example: "jane@example.com"
    qr_email:
      type: string
      format: email
      maxLength: 255
      description: Alternative email for QR code distribution
      example: "jane.work@example.com"
      nullable: true
    employee_id:
      type: string
      maxLength: 255
      description: Employee or staff ID
      example: "EMP001"
      nullable: true
    phone:
      type: string
      description: Phone number in E.164 format
      example: "+1-555-0123"
      nullable: true
    status:
      $ref: './enums.yaml#/ParticipantStatus'
    qr_code:
      type: string
      description: QR code token (unique)
      example: "evt_550e8400_prt_770e8400_abc123def456"
      readOnly: true
    qr_code_generated_at:
      type: string
      format: date-time
      description: QR code generation timestamp (ISO 8601)
      example: "2025-11-08T10:00:00Z"
      readOnly: true
    qr_distribution_url:
      type: string
      format: uri
      description: Distribution URL for the QR code (only available when QR_HOSTING_BASE_URL is configured)
      example: "https://qr.example.com/qr/ZXZ0XzU1MGU4NDAwX3BydF83NzBlODQwMF..."
      nullable: true
      readOnly: true
    metadata:
      type: object
      description: Custom participant data (max 10KB JSON, not included in list responses)
      additionalProperties: true
      example:
        company: "Tech Corp"
        role: "Engineer"
        dietary_restrictions: ["vegetarian"]
    payment_status:
      $ref: './enums.yaml#/PaymentStatus'
    payment_amount:
      type: number
      format: double
      description: Payment amount (decimal, 2 places)
      example: 150.0
      nullable: true
    payment_date:
      type: string
      format: date-time
      description: Payment date/time (ISO 8601)
      example: "2025-11-08T12:30:00Z"
      nullable: true
    checked_in:
      type: boolean
      description: Check-in status
      example: false
      readOnly: true
    checked_in_at:
      type: string
      format: date-time
      description: Check-in timestamp (ISO 8601)
      example: "2025-12-15T09:15:00Z"
      nullable: true
      readOnly: true
    created_at:
      type: string
      format: date-time
      description: Creation timestamp (ISO 8601)
      example: "2025-11-08T10:00:00Z"
      readOnly: true
    updated_at:
      type: string
      format: date-time
      description: Last update timestamp (ISO 8601)
      example: "2025-11-08T10:00:00Z"
      readOnly: true

CheckIn:
  type: object
  required:
    - id
    - event_id
    - participant_id
    - checked_in_at
    - checkin_method
  properties:
    id:
      type: string
      format: uuid
      description: Check-in unique identifier
      example: "880e8400-e29b-41d4-a716-446655440000"
      readOnly: true
    event_id:
      type: string
      format: uuid
      description: Associated event ID
      example: "550e8400-e29b-41d4-a716-446655440000"
      readOnly: true
    participant_id:
      type: string
      format: uuid
      description: Checked-in participant ID
      example: "770e8400-e29b-41d4-a716-446655440000"
      readOnly: true
    checked_in_at:
      type: string
      format: date-time
      description: Check-in timestamp (ISO 8601, default NOW())
      example: "2025-12-15T09:15:00Z"
      readOnly: true
    checked_in_by:
      type: object
      description: User who performed check-in
      readOnly: true
      properties:
        id:
          type: string
          format: uuid
          example: "660e8400-e29b-41d4-a716-446655440000"
        name:
          type: string
          example: "Staff User"
    checkin_method:
      $ref: './enums.yaml#/CheckInMethod'
    device_info:
      type: object
      description: Device metadata (max 5KB JSON)
      additionalProperties: true
      example:
        device_type: "mobile"
        os: "iOS"
        app_version: "1.0.0"
