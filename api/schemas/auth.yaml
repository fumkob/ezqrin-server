# Authentication Request and Response Schemas
# Used for login, registration, and token management

RegisterRequest:
  type: object
  required:
    - email
    - password
    - name
    - role
  properties:
    email:
      type: string
      format: email
      minLength: 1
      maxLength: 255
      description: Email address (must be unique)
      example: "organizer@example.com"
    password:
      type: string
      format: password
      minLength: 8
      maxLength: 255
      description: Password (minimum 8 characters)
      example: "SecureP@ssw0rd"
    name:
      type: string
      minLength: 2
      maxLength: 255
      description: Full name
      example: "John Doe"
    role:
      $ref: './enums.yaml#/UserRole'

LoginRequest:
  type: object
  required:
    - email
    - password
  properties:
    email:
      type: string
      format: email
      description: Email address
      example: "organizer@example.com"
    password:
      type: string
      format: password
      description: User password
      example: "SecureP@ssw0rd"

RefreshTokenRequest:
  type: object
  required:
    - refresh_token
  properties:
    refresh_token:
      type: string
      description: Valid refresh token obtained from login or previous refresh
      example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI1NTBlODQwMC1lMjliLTQxZDQtYTcxNi00NDY2NTU0NDAwMDAiLCJ0eXBlIjoicmVmcmVzaCIsImV4cCI6MTY0MDk5NTIwMH0.x7j8KqX2Y3Z4a5b6c7d8e9f0g1h2i3j4k5l6m7n8o9p0"

AuthResponse:
  type: object
  required:
    - access_token
    - refresh_token
    - token_type
    - expires_in
    - user
  properties:
    access_token:
      type: string
      description: JWT access token for API authentication
      example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI1NTBlODQwMC1lMjliLTQxZDQtYTcxNi00NDY2NTU0NDAwMDAiLCJyb2xlIjoib3JnYW5pemVyIiwiZXhwIjoxNjQwOTk1MjAwfQ.abc123def456ghi789jkl012mno345pqr678stu901vwx234yz"
    refresh_token:
      type: string
      description: Refresh token for obtaining new access tokens
      example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI1NTBlODQwMC1lMjliLTQxZDQtYTcxNi00NDY2NTU0NDAwMDAiLCJ0eXBlIjoicmVmcmVzaCIsImV4cCI6MTY0MDk5NTIwMH0.x7j8KqX2Y3Z4a5b6c7d8e9f0g1h2i3j4k5l6m7n8o9p0"
    token_type:
      type: string
      description: Token type (always "Bearer")
      example: "Bearer"
      default: "Bearer"
    expires_in:
      type: integer
      description: Access token expiration time in seconds (900 = 15 minutes)
      example: 900
      default: 900
    user:
      $ref: './entities.yaml#/User'

LogoutResponse:
  type: object
  required:
    - message
  properties:
    message:
      type: string
      description: Confirmation message
      example: "Successfully logged out"
