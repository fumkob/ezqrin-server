openapi: 3.0.3
info:
  title: ezQRin API
  version: 1.0.0
  description: |
    Event management and QR check-in system API

    ## Overview

    The ezQRin API is a comprehensive event management platform that enables organizers to:
    - Create and manage events
    - Register participants and distribute QR codes
    - Track check-ins and generate reports
    - Manage user accounts and authentication

    ## Authentication

    The API uses JWT Bearer tokens for authentication. Include the token in the Authorization header:

    ```
    Authorization: Bearer <access_token>
    ```

    **Token Types:**
    - Access Token: Valid for 15 minutes
    - Refresh Token: Valid for 7 days

    ## API-First Development

    This OpenAPI specification serves as the **Single Source of Truth (SSOT)** for all API contracts.
    Server code, client SDKs, and validation schemas are generated from this specification using `oapi-codegen`.

    ## Rate Limiting

    API requests are rate-limited to prevent abuse. Rate limit information is included in response headers:
    - `X-RateLimit-Limit`: Maximum requests per window
    - `X-RateLimit-Remaining`: Remaining requests in current window
    - `X-RateLimit-Reset`: Unix timestamp when limit resets

    For detailed rate limits, see the [Rate Limiting documentation](./docs/api/rate_limits.md).

  contact:
    name: ezQRin Support
    email: support@ezqrin.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

servers:
  - url: http://localhost:8080/api/v1
    description: Development server
  - url: https://api.ezqrin.com/v1
    description: Production server

tags:
  - name: health
    description: Health check and system status endpoints
  - name: auth
    description: Authentication and authorization
  - name: users
    description: User account management
  - name: events
    description: Event lifecycle management
  - name: participants
    description: Participant registration and management
  - name: qrcode
    description: QR code generation and distribution
  - name: checkin
    description: Check-in operations and tracking

paths:
  # Health check endpoints
  /health:
    $ref: './paths/health.yaml#/~1health'
  /health/ready:
    $ref: './paths/health.yaml#/~1health~1ready'
  /health/live:
    $ref: './paths/health.yaml#/~1health~1live'

  # Authentication endpoints
  /auth/register:
    $ref: './paths/auth.yaml#/~1auth~1register'
  /auth/login:
    $ref: './paths/auth.yaml#/~1auth~1login'
  /auth/refresh:
    $ref: './paths/auth.yaml#/~1auth~1refresh'
  /auth/logout:
    $ref: './paths/auth.yaml#/~1auth~1logout'

  # Event endpoints
  /events:
    $ref: './paths/events.yaml#/~1events'
  /events/{id}:
    $ref: './paths/events.yaml#/~1events~1{id}'
  /events/{id}/stats:
    $ref: './paths/events.yaml#/~1events~1{id}~1stats'

  # Participant endpoints
  /events/{id}/participants:
    $ref: './paths/participants.yaml#/~1events~1{id}~1participants'
  /events/{id}/participants/bulk:
    $ref: './paths/participants.yaml#/~1events~1{id}~1participants~1bulk'
  /participants/{id}:
    $ref: './paths/participants.yaml#/~1participants~1{id}'
  /participants/{id}/qrcode:
    $ref: './paths/participants.yaml#/~1participants~1{id}~1qrcode'

  # Check-in endpoints
  /events/{id}/checkin:
    $ref: './paths/checkin.yaml#/~1events~1{id}~1checkin'
  /events/{id}/checkins:
    $ref: './paths/checkin.yaml#/~1events~1{id}~1checkins'
  /events/{id}/checkins/{cid}:
    $ref: './paths/checkin.yaml#/~1events~1{id}~1checkins~1{cid}'
  /participants/{id}/checkin-status:
    $ref: './paths/checkin.yaml#/~1participants~1{id}~1checkin-status'

  # Future endpoints will be added here as separate YAML files:
  # Users: ./paths/users.yaml

components:
  securitySchemes:
    bearerAuth:
      $ref: './components/security.yaml#/bearerAuth'

  schemas:
    # Core entities
    User:
      $ref: './schemas/entities.yaml#/User'
    Event:
      $ref: './schemas/entities.yaml#/Event'
    Participant:
      $ref: './schemas/entities.yaml#/Participant'
    CheckIn:
      $ref: './schemas/entities.yaml#/CheckIn'

    # Authentication schemas
    RegisterRequest:
      $ref: './schemas/auth.yaml#/RegisterRequest'
    LoginRequest:
      $ref: './schemas/auth.yaml#/LoginRequest'
    RefreshTokenRequest:
      $ref: './schemas/auth.yaml#/RefreshTokenRequest'
    AuthResponse:
      $ref: './schemas/auth.yaml#/AuthResponse'
    LogoutResponse:
      $ref: './schemas/auth.yaml#/LogoutResponse'

    # Event schemas
    CreateEventRequest:
      $ref: './schemas/events.yaml#/CreateEventRequest'
    UpdateEventRequest:
      $ref: './schemas/events.yaml#/UpdateEventRequest'
    EventListResponse:
      $ref: './schemas/events.yaml#/EventListResponse'
    EventStatsResponse:
      $ref: './schemas/events.yaml#/EventStatsResponse'

    # Participant schemas
    CreateParticipantRequest:
      $ref: './schemas/participants.yaml#/CreateParticipantRequest'
    UpdateParticipantRequest:
      $ref: './schemas/participants.yaml#/UpdateParticipantRequest'
    BulkCreateParticipantsRequest:
      $ref: './schemas/participants.yaml#/BulkCreateParticipantsRequest'
    BulkCreateParticipantsResponse:
      $ref: './schemas/participants.yaml#/BulkCreateParticipantsResponse'
    ParticipantListResponse:
      $ref: './schemas/participants.yaml#/ParticipantListResponse'

    # Check-in schemas
    CheckInRequest:
      $ref: './schemas/checkin.yaml#/CheckInRequest'
    CheckInResponse:
      $ref: './schemas/checkin.yaml#/CheckInResponse'
    CheckInListResponse:
      $ref: './schemas/checkin.yaml#/CheckInListResponse'
    CheckInStatusResponse:
      $ref: './schemas/checkin.yaml#/CheckInStatusResponse'

    # Enums
    UserRole:
      $ref: './schemas/enums.yaml#/UserRole'
    EventStatus:
      $ref: './schemas/enums.yaml#/EventStatus'
    ParticipantStatus:
      $ref: './schemas/enums.yaml#/ParticipantStatus'
    PaymentStatus:
      $ref: './schemas/enums.yaml#/PaymentStatus'
    CheckInMethod:
      $ref: './schemas/enums.yaml#/CheckInMethod'

    # Response schemas
    ProblemDetails:
      $ref: './schemas/responses.yaml#/ProblemDetails'
    ListResponse:
      $ref: './schemas/responses.yaml#/ListResponse'
    PaginationMeta:
      $ref: './schemas/responses.yaml#/PaginationMeta'
    ValidationError:
      $ref: './schemas/responses.yaml#/ValidationError'

  responses:
    BadRequest:
      $ref: './components/responses.yaml#/BadRequest'
    Unauthorized:
      $ref: './components/responses.yaml#/Unauthorized'
    Forbidden:
      $ref: './components/responses.yaml#/Forbidden'
    NotFound:
      $ref: './components/responses.yaml#/NotFound'
    Conflict:
      $ref: './components/responses.yaml#/Conflict'
    ValidationErrorResponse:
      $ref: './components/responses.yaml#/ValidationErrorResponse'
    RateLimitExceeded:
      $ref: './components/responses.yaml#/RateLimitExceeded'
    InternalError:
      $ref: './components/responses.yaml#/InternalError'
    ServiceUnavailable:
      $ref: './components/responses.yaml#/ServiceUnavailable'

  parameters:
    PageParam:
      $ref: './components/parameters.yaml#/PageParam'
    PerPageParam:
      $ref: './components/parameters.yaml#/PerPageParam'
    SortParam:
      $ref: './components/parameters.yaml#/SortParam'
    OrderParam:
      $ref: './components/parameters.yaml#/OrderParam'
    EventIDParam:
      $ref: './components/parameters.yaml#/EventIDParam'
    ParticipantIDParam:
      $ref: './components/parameters.yaml#/ParticipantIDParam'
    CheckInIDParam:
      $ref: './components/parameters.yaml#/CheckInIDParam'

security:
  - bearerAuth: []
